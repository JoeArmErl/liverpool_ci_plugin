/*
 * This source file was generated by the Gradle 'init' task
 */
package com.liverpool.ci

import org.gradle.testfixtures.ProjectBuilder
import org.gradle.api.Project
import spock.lang.Specification

/**
 * A simple unit test for the 'com.liverpool.ci.greeting' plugin.
 */
class LiverpoolCiGradlePluginTest extends Specification {
    def "applying plugin creates archUnit extension and applies defaults"() {
        given:
        def project = ProjectBuilder.builder().build()

        when:
        project.pluginManager.apply('com.liverpool.ci')

        then:
        // Extension registered
        def ext = project.extensions.findByType(ArchUnitExtension)
        ext != null

        // Defaults from arch-unit.gradle
        ext.excludedPaths == ['controller.model','application.data']
        ext.preConfiguredRules.contains('com.societegenerale.commons.plugin.rules.NoInjectedFieldTest')
    }
}
